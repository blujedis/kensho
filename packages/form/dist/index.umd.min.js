/*!
 * @kensho/form v0.0.0
 * (c) Blujedi LLC
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["@kensho/form"]={})}(this,(function(t){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n="__lodash_hash_undefined__",r="[object Function]",o="[object GeneratorFunction]",i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/,u=/^\./,c=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,l=/\\(\\)?/g,s=/^\[object .+?Constructor\]$/,f="object"==typeof e&&e&&e.Object===Object&&e,p="object"==typeof self&&self&&self.Object===Object&&self,d=f||p||Function("return this")();var h,y=Array.prototype,v=Function.prototype,_=Object.prototype,b=d["__core-js_shared__"],g=(h=/[^.]+$/.exec(b&&b.keys&&b.keys.IE_PROTO||""))?"Symbol(src)_1."+h:"",m=v.toString,j=_.hasOwnProperty,O=_.toString,A=RegExp("^"+m.call(j).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),w=d.Symbol,E=y.splice,$=P(d,"Map"),T=P(Object,"create"),x=w?w.prototype:void 0,V=x?x.toString:void 0;function k(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function S(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function F(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function L(t,e){for(var n,r,o=t.length;o--;)if((n=t[o][0])===(r=e)||n!=n&&r!=r)return o;return-1}function N(t,e){var n;e=function(t,e){if(D(t))return!1;var n=typeof t;if("number"==n||"symbol"==n||"boolean"==n||null==t||q(t))return!0;return a.test(t)||!i.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:D(n=e)?n:M(n);for(var r=0,o=e.length;null!=t&&r<o;)t=t[R(e[r++])];return r&&r==o?t:void 0}function I(t){if(!G(t)||(e=t,g&&g in e))return!1;var e,n=function(t){var e=G(t)?O.call(t):"";return e==r||e==o}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?A:s;return n.test(function(t){if(null!=t){try{return m.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function C(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function P(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return I(n)?n:void 0}k.prototype.clear=function(){this.__data__=T?T(null):{}},k.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},k.prototype.get=function(t){var e=this.__data__;if(T){var r=e[t];return r===n?void 0:r}return j.call(e,t)?e[t]:void 0},k.prototype.has=function(t){var e=this.__data__;return T?void 0!==e[t]:j.call(e,t)},k.prototype.set=function(t,e){return this.__data__[t]=T&&void 0===e?n:e,this},S.prototype.clear=function(){this.__data__=[]},S.prototype.delete=function(t){var e=this.__data__,n=L(e,t);return!(n<0)&&(n==e.length-1?e.pop():E.call(e,n,1),!0)},S.prototype.get=function(t){var e=this.__data__,n=L(e,t);return n<0?void 0:e[n][1]},S.prototype.has=function(t){return L(this.__data__,t)>-1},S.prototype.set=function(t,e){var n=this.__data__,r=L(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},F.prototype.clear=function(){this.__data__={hash:new k,map:new($||S),string:new k}},F.prototype.delete=function(t){return C(this,t).delete(t)},F.prototype.get=function(t){return C(this,t).get(t)},F.prototype.has=function(t){return C(this,t).has(t)},F.prototype.set=function(t,e){return C(this,t).set(t,e),this};var M=z((function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(q(t))return V?V.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}(e);var n=[];return u.test(t)&&n.push(""),t.replace(c,(function(t,e,r,o){n.push(r?o.replace(l,"$1"):e||t)})),n}));function R(t){if("string"==typeof t||q(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function z(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a),a};return n.cache=new(z.Cache||F),n}z.Cache=F;var D=Array.isArray;function G(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function q(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==O.call(t)}var U=function(t,e,n){var r=null==t?void 0:N(t,e);return void 0===r?n:r},B="__lodash_hash_undefined__",W="[object Function]",X="[object GeneratorFunction]",H=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,J=/^\w*$/,K=/^\./,Q=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Y=/\\(\\)?/g,Z=/^\[object .+?Constructor\]$/,tt=/^(?:0|[1-9]\d*)$/,et="object"==typeof e&&e&&e.Object===Object&&e,nt="object"==typeof self&&self&&self.Object===Object&&self,rt=et||nt||Function("return this")();var ot=Array.prototype,it=Function.prototype,at=Object.prototype,ut=rt["__core-js_shared__"],ct=function(){var t=/[^.]+$/.exec(ut&&ut.keys&&ut.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),lt=it.toString,st=at.hasOwnProperty,ft=at.toString,pt=RegExp("^"+lt.call(st).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),dt=rt.Symbol,ht=ot.splice,yt=Tt(rt,"Map"),vt=Tt(Object,"create"),_t=dt?dt.prototype:void 0,bt=_t?_t.toString:void 0;function gt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function mt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function jt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Ot(t,e,n){var r=t[e];st.call(t,e)&&Ft(r,n)&&(void 0!==n||e in t)||(t[e]=n)}function At(t,e){for(var n=t.length;n--;)if(Ft(t[n][0],e))return n;return-1}function wt(t){if(!Nt(t)||(e=t,ct&&ct in e))return!1;var e,n=function(t){var e=Nt(t)?ft.call(t):"";return e==W||e==X}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?pt:Z;return n.test(function(t){if(null!=t){try{return lt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function Et(t,e,n,r){if(!Nt(t))return t;e=function(t,e){if(Lt(t))return!1;var n=typeof t;if("number"==n||"symbol"==n||"boolean"==n||null==t||It(t))return!0;return J.test(t)||!H.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:function(t){return Lt(t)?t:Vt(t)}(e);for(var o=-1,i=e.length,a=i-1,u=t;null!=u&&++o<i;){var c=kt(e[o]),l=n;if(o!=a){var s=u[c];void 0===(l=r?r(s,c,u):void 0)&&(l=Nt(s)?s:xt(e[o+1])?[]:{})}Ot(u,c,l),u=u[c]}return t}function $t(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function Tt(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return wt(n)?n:void 0}function xt(t,e){return!!(e=null==e?9007199254740991:e)&&("number"==typeof t||tt.test(t))&&t>-1&&t%1==0&&t<e}gt.prototype.clear=function(){this.__data__=vt?vt(null):{}},gt.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},gt.prototype.get=function(t){var e=this.__data__;if(vt){var n=e[t];return n===B?void 0:n}return st.call(e,t)?e[t]:void 0},gt.prototype.has=function(t){var e=this.__data__;return vt?void 0!==e[t]:st.call(e,t)},gt.prototype.set=function(t,e){return this.__data__[t]=vt&&void 0===e?B:e,this},mt.prototype.clear=function(){this.__data__=[]},mt.prototype.delete=function(t){var e=this.__data__,n=At(e,t);return!(n<0)&&(n==e.length-1?e.pop():ht.call(e,n,1),!0)},mt.prototype.get=function(t){var e=this.__data__,n=At(e,t);return n<0?void 0:e[n][1]},mt.prototype.has=function(t){return At(this.__data__,t)>-1},mt.prototype.set=function(t,e){var n=this.__data__,r=At(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},jt.prototype.clear=function(){this.__data__={hash:new gt,map:new(yt||mt),string:new gt}},jt.prototype.delete=function(t){return $t(this,t).delete(t)},jt.prototype.get=function(t){return $t(this,t).get(t)},jt.prototype.has=function(t){return $t(this,t).has(t)},jt.prototype.set=function(t,e){return $t(this,t).set(t,e),this};var Vt=St((function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(It(t))return bt?bt.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}(e);var n=[];return K.test(t)&&n.push(""),t.replace(Q,(function(t,e,r,o){n.push(r?o.replace(Y,"$1"):e||t)})),n}));function kt(t){if("string"==typeof t||It(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function St(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a),a};return n.cache=new(St.Cache||jt),n}function Ft(t,e){return t===e||t!=t&&e!=e}St.Cache=jt;var Lt=Array.isArray;function Nt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function It(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==ft.call(t)}var Ct=function(t,e,n){return null==t?t:Et(t,e,n)},Pt="__lodash_hash_undefined__",Mt=9007199254740991,Rt="[object Arguments]",zt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Dt=/^\w*$/,Gt=/^\./,qt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ut=/\\(\\)?/g,Bt=/^\[object .+?Constructor\]$/,Wt=/^(?:0|[1-9]\d*)$/,Xt="object"==typeof e&&e&&e.Object===Object&&e,Ht="object"==typeof self&&self&&self.Object===Object&&self,Jt=Xt||Ht||Function("return this")();var Kt=Array.prototype,Qt=Function.prototype,Yt=Object.prototype,Zt=Jt["__core-js_shared__"],te=function(){var t=/[^.]+$/.exec(Zt&&Zt.keys&&Zt.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),ee=Qt.toString,ne=Yt.hasOwnProperty,re=Yt.toString,oe=RegExp("^"+ee.call(ne).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ie=Jt.Symbol,ae=Yt.propertyIsEnumerable,ue=Kt.splice,ce=ge(Jt,"Map"),le=ge(Object,"create"),se=ie?ie.prototype:void 0,fe=se?se.toString:void 0;function pe(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function de(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function he(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function ye(t,e){for(var n,r,o=t.length;o--;)if((n=t[o][0])===(r=e)||n!=n&&r!=r)return o;return-1}function ve(t,e){return null!=t&&ne.call(t,e)}function _e(t){if(!Te(t)||(e=t,te&&te in e))return!1;var e,n=Ee(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?oe:Bt;return n.test(function(t){if(null!=t){try{return ee.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function be(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function ge(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return _e(n)?n:void 0}function me(t,e,n){var r;e=function(t,e){if(we(t))return!1;var n=typeof t;if("number"==n||"symbol"==n||"boolean"==n||null==t||Ve(t))return!0;return Dt.test(t)||!zt.test(t)||null!=e&&t in Object(e)}(e,t)?[e]:we(r=e)?r:je(r);for(var o,i=-1,a=e.length;++i<a;){var u=Oe(e[i]);if(!(o=null!=t&&n(t,u)))break;t=t[u]}return o||!!(a=t?t.length:0)&&$e(a)&&function(t,e){return!!(e=null==e?Mt:e)&&("number"==typeof t||Wt.test(t))&&t>-1&&t%1==0&&t<e}(u,a)&&(we(t)||function(t){return function(t){return xe(t)&&function(t){return null!=t&&$e(t.length)&&!Ee(t)}(t)}(t)&&ne.call(t,"callee")&&(!ae.call(t,"callee")||re.call(t)==Rt)}(t))}pe.prototype.clear=function(){this.__data__=le?le(null):{}},pe.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},pe.prototype.get=function(t){var e=this.__data__;if(le){var n=e[t];return n===Pt?void 0:n}return ne.call(e,t)?e[t]:void 0},pe.prototype.has=function(t){var e=this.__data__;return le?void 0!==e[t]:ne.call(e,t)},pe.prototype.set=function(t,e){return this.__data__[t]=le&&void 0===e?Pt:e,this},de.prototype.clear=function(){this.__data__=[]},de.prototype.delete=function(t){var e=this.__data__,n=ye(e,t);return!(n<0)&&(n==e.length-1?e.pop():ue.call(e,n,1),!0)},de.prototype.get=function(t){var e=this.__data__,n=ye(e,t);return n<0?void 0:e[n][1]},de.prototype.has=function(t){return ye(this.__data__,t)>-1},de.prototype.set=function(t,e){var n=this.__data__,r=ye(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},he.prototype.clear=function(){this.__data__={hash:new pe,map:new(ce||de),string:new pe}},he.prototype.delete=function(t){return be(this,t).delete(t)},he.prototype.get=function(t){return be(this,t).get(t)},he.prototype.has=function(t){return be(this,t).has(t)},he.prototype.set=function(t,e){return be(this,t).set(t,e),this};var je=Ae((function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(Ve(t))return fe?fe.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}(e);var n=[];return Gt.test(t)&&n.push(""),t.replace(qt,(function(t,e,r,o){n.push(r?o.replace(Ut,"$1"):e||t)})),n}));function Oe(t){if("string"==typeof t||Ve(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function Ae(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a),a};return n.cache=new(Ae.Cache||he),n}Ae.Cache=he;var we=Array.isArray;function Ee(t){var e=Te(t)?re.call(t):"";return"[object Function]"==e||"[object GeneratorFunction]"==e}function $e(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Mt}function Te(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function xe(t){return!!t&&"object"==typeof t}function Ve(t){return"symbol"==typeof t||xe(t)&&"[object Symbol]"==re.call(t)}var ke=function(t,e){return null!=t&&me(t,e,ve)};const Se=["INPUT","SELECT","TEXTAREA"],Fe=["email","number","date","datetime-local","time","url","tel","color","textarea"],Le={string:String,number:Number,integer:t=>{try{return parseInt(t+"")}catch(e){return t}},float:(t,e=2)=>{try{const n=parseFloat(t+"");return Number(n.toFixed(e))}catch(e){return t}},bigint:t=>{try{return BigInt(t+"")}catch(e){return t}},boolean:t=>!!/(true|yes|1)/.test(t+""),array:(t,e="string")=>ze(t).map((t=>Le[e])),none:t=>t};function Ne(t,e){if(void 0===t)return function(t){let e=!1,n="none",r=[];if(Array.isArray(t)&&(t=t[0],e=!0),"string"==typeof t)n="string";else if("boolean"==typeof t)n="boolean";else if("number"==typeof t){const e=t%1!=0;n=e?"float":"integer";const o=e?Math.max(0,(t+"").split(".").length):0;o&&(r=[o])}return e&&(n=`[${n}]`),{dataType:n,dataTypeOptions:r}}(e);const n=t.split("|");return{dataType:n.shift()||"none",dataTypeOptions:[...n]}}function Ie(t){const e={type:t.type,required:t.hasAttribute("required"),readonly:t.hasAttribute("readonly"),disabled:t.hasAttribute("disabled"),pattern:t.getAttribute("pattern")||"",min:t.getAttribute("min"),max:t.getAttribute("min"),minlength:t.getAttribute("min"),maxlength:t.getAttribute("min"),step:t.getAttribute("min")};return e.min=null!==e.min?parseInt(e.min+""):null,e.max=null!==e.max?parseInt(e.max+""):null,e.minlength=null!==e.minlength?parseInt(e.minlength+""):null,e.maxlength=null!==e.maxlength?parseInt(e.maxlength+""):null,e.step=null!==e.step?parseInt(e.step+""):null,e}function Ce(t,e=Se){return e.includes(t.nodeName)}function Pe(t=16){return"#"+(16777215*Math.random()<<0).toString(t)}function Me(t,e=Se,n=0){let r=[];if(Ce(t,e)&&r.push(t),n>20)return r;if(t.childNodes){const o=Array.from(t.childNodes).reduce(((t,r)=>t=[...t,...Me(r,e,n=1)]),[]);r=[...r,...o]}return r}function Re(t,e,n=Se){const r=new MutationObserver((t=>{for(let r=0;r<t.length;++r){for(let o=0;o<t[r].addedNodes.length;++o){const i=t[r].addedNodes[o];Ce(i,n)&&e(i,"add")}for(let o=0;o<t[r].removedNodes.length;++o){const i=Me(t[r].removedNodes[o],n);i.length&&i.forEach((t=>e(t,"remove")))}}}));return r.observe(t,{childList:!0,subtree:!0}),()=>r.disconnect()}function ze(t){return Array.isArray(t)||null==t?t||[]:[t]}function De(t,e){if(console.log("placeholder types:",e),!1===e)return!1;return(e?!0===e?Fe:e:Fe).includes(t.type)}function Ge(t){if(!t)return"";const e=t.split(".");let n=e.shift();return n=n?.charAt(0).toUpperCase()+n?.slice(1),[n,...e].join(" ")}const qe={text:[Xe,Be],email:[Xe,Be],tel:[Xe,Be],"select-one":[He,We],"select-multiple":[He,We],checkbox:[function(t){const e=t.el;return e?e.checked:t.virtualValue},function(t,e){const n=t.el;n?/(true|1|yes)/.test(e+"")&&n.setAttribute("checked","true"):t.virtualValue=!!/(true|1|yes)/.test(e+"")}],password:[Xe,Be],textarea:[Xe,Be],radio:[function(t){let e;const n=t.el;for(const t of n){if(void 0!==e)return e;t.checked&&(e=t.value)}return e},function(t,e){const n=t.el;n?n.forEach((t=>{t.value===e&&t.setAttribute("checked","true")})):t.virtualValue=e}],color:[Xe,Be],date:[Xe,Be],"datetime-local":[Xe,Be],file:[function(t){const e=t.el;return e.files?Array.from(e.files):[]},function(...t){}],hidden:[Xe,Be],month:[Xe,Be],number:[Xe,Be],range:[Xe,Be],time:[Xe,Be],url:[Xe,Be],week:[Xe,Be]},Ue=Object.keys(qe);function Be(t,e){const n=t.el;n?n.value=e+"":t.virtualValue=e}function We(t,e){const n=t.el;if(n){const t=ze(e);"select-multiple"===n.type?Array.from(n.children).forEach((e=>{const n=e,r=n.value;t.includes(r)?n.selected=!0:n.selected=!1})):n.value=e+""}else t.virtualValue=ze(e)}function Xe(t){const e=t.el;return e?e.value:t.virtualValue}function He(t){const e=t.el;if("select-multiple"===e.type){const t=[];return Array.from(e.children).forEach((e=>{const n=e;n.selected&&t.push(n.value)})),t}return e.value}const Je={initialized:!1,validating:!1,pristine:!0,dirty:!1,valid:!0,invalid:!1,submitting:!1,submitted:!1};t.default=function(t){let e;(t={initValidate:!0,flattenOutput:!1,castValues:!0,placeholders:!1,...t}).initialValues={...t.initialValues};const n={};let r,o=[],i={...Je},a={},u={};const c={form:function(e){return e?(V(e).then((()=>{f({initialized:!0})})),r=Re(e,((t,e)=>{i.submitted||("remove"===e?T(t):$(t))}),t.mutationNodes),{destroy:x}):{destroy:x}},field:E,reset:w,getValue:y,getValues:v,setValue:_,setValues:b,getFields:function(){return Object.keys(n).reduce(((t,e)=>(t[e]=E(e),t)),{})},validate:h,destroy:x,getNativeValidators:function(t){const e=n[t]?.el;return e?Array.isArray(e)?e.map((t=>Ie(t))):Ie(e):{}},subscribe:s};function l(){let e=a;return t.flattenOutput||(e=Object.entries(e).reduce(((t,[e,n])=>(Ct(t,e,n),t)),{})),{...i,errors:u,fields:e}}function s(t){return o.includes(t)||o.push(t),()=>{o=o.filter((e=>e!==t))}}function f(t=i){const e=Object.keys(u||{}).length>0;if(i={...i,valid:!e,invalid:e,...t},i.initialized)for(const t of o)t(l())}function p(t,e){const n=ke(u,t);a[t]={...a[t],valid:!n,invalid:n,...e};const{hasDirty:r,hasTouched:o}=function(){let t=!1,e=!1;for(const[,n]of Object.entries(a)){if(t&&e)break;t=n.dirty,e=n.touched}return{hasDirty:t,hasTouched:e}}();f({dirty:r,pristine:!o&&!r})}function d(t){const{[t]:e,...n}=a;a=n,f()}async function h(e=v()){if(i.validating)return u;const n=t.validator||(()=>{!1===t.validator||i.initialized||console.warn('Failed to validate, validation handler NOT defined. To suppress this warning set "validator:false"')});f({validating:!0});const r=await n(e);return u=t.flattenOutput?function(t,e="."){const n={},r=(t,o)=>{for(const[i,a]of Object.entries(t)){const t=o?`${o}${e}${i}`:i;a&&"object"==typeof a&&!Array.isArray(a)?r(a,t):n[t]=a}return n};return r(t)}(r||{}):r,setTimeout((()=>{f({validating:!1})}),100),u}function y(e,r=!1){const o=n[e];if(!o)return;let i=qe[o.type][0](o);return t.castValues&&(i=function(t,e,n){const r=t.startsWith("["),o=t.replace(/([|])/g,"");return"none"!==o&&Le[o]?r?ze(n).map((t=>Le[o](t,...e))):Le[o](n,...e):n}(o.dataType,o.dataTypeOptions,i)),i}function v(t=!1){const e={},r=Object.keys(n);for(const n of r){const r=y(n);void 0!==r&&(t?e[n]=r:Ct(e,n,r))}return e}function _(t,e){if(void 0===e)return;const r=n[t];if(!r)return;(0,qe[r.type][1])(r,e)}function b(t){if(void 0===t)return;const e=Object.entries(n);if(e&&e.length)for(const[n]of e){_(n,U(t,n))}}function g(t){const e=n[t];return e?e.defaultValue:null}function m(t){if(i.submitted)return;const e=t.currentTarget;p(e.name,{touched:!0}),e.removeEventListener("click",m),e.removeEventListener("touchend",m)}async function j(t){if(i.submitted)return;const e=t.currentTarget,n=y(e.name),r=g(e.name);n!==r?p(e.name,{dirty:!0,touched:!0,pristine:!1}):n===r&&p(e.name,{dirty:!1,touched:!0,pristine:!1}),await h()}function O(t){t.preventDefault(),w()}async function A(e){if(e.preventDefault(),i.submitting||i.submitted)return!1;f({submitting:!0});const n=v();return u=await h(n),u=u||{},Object.keys(u).length?(t.onError&&t.onError(u,c),!1):(t.onSubmit(n,c),setTimeout((()=>{f({submitting:!1,submitted:!0,pristine:!1})}),100),!1)}async function w(n){e.reset(),b(n||{...t.initialValues}),u={},f({...Je}),await h()}function E(t,e){const r=n[t]?.el,o=void 0!==e;if(o&&!Array.isArray(r))throw new Error(`Attempted to index non indexable field "${t}".`);const u=o?r[e]:r,c=a[t]||{};return{el:u,get value(){return y(t)},set value(e){i.submitted||_(t,e)},get pristine(){return c.pristine},get dirty(){return c.dirty},get touched(){return c.touched},get invalid(){return c.invalid},get valid(){return c.valid},reset:()=>{i.submitted||(_(t,g(t)),p(t,{dirty:!1,touched:!1,pristine:!0}))},validate:async()=>{if(i.submitted)return;const e={[t]:y(t)};return(await h(e))[t]}}}function $(...e){for(const r of e){if(!Ue.includes(r.type)||""===r.dataset.unbound)continue;r.name||(r.name=Pe());const e=r.name;let o=U(t.initialValues,e);Array.isArray(o)&&"select-multiple"!==r.type&&(console.warn(`Element ${r.name} default value is an Array but is not of type select-multiple. Only the first value will be used.`),o=o[0]||"");const i=Ne(r.dataset.datatype,o);if("radio"===r.type){if(n[e]=n[e]||{},n[e].el=ze(n[e].el),n[e].el.includes(r))continue;n[e].el.push(r),n[e].type=r.type,n[e].defaultValue=o||r.checked&&r.value||"",n[e].virtualValue=void 0,n[e].dataType=i.dataType,n[e].dataTypeOptions=i.dataTypeOptions}else{if(void 0!==n[e])continue;n[e]={type:r.type,el:r,defaultValue:o||r.value,virtualValue:void 0,...i}}if(t.placeholders&&De(r,t.placeholders)&&!r.hasAttribute("placeholder")){const t=Ge(r.name);t&&r.setAttribute("placeholder",t)}r.addEventListener("change",j),r.addEventListener("click",m),r.addEventListener("touchend",m),void 0!==o&&_(e,U(t.initialValues,e)),p(e,{pristine:!0,value:o,valid:!0,invalid:!1,touched:!1,dirty:!1})}}function T(...t){for(const e of t){const t=n[e.name];if(t){if(Array.isArray(t.el)){n[e.name].el=t.el.filter((t=>t!==e));n[e.name].el.length||delete n[e.name]}else delete n[e.name];d(e.name),e.removeEventListener("change",j),e.removeEventListener("click",m),e.removeEventListener("touchend",m)}}}function x(){T(...Object.keys(n).reduce(((t,e)=>Array.isArray(e)?[...t,...e]:[...t,e]),[])),r&&r(),e.removeEventListener("submit",A),e.removeEventListener("reset",O)}async function V(n){$(...Array.from(n.elements)),n.setAttribute("novalidate","novalidate"),n.addEventListener("submit",A),n.addEventListener("reset",O),e=n,t.subscribe&&s(t.subscribe),t.initValidate&&await h(t.initialValues)}return c},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=index.umd.min.js.map
